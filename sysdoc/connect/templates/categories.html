<!DOCTYPE html>
<html>

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0"/>
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-touch-fullscreen" content="yes" />
	<meta name="theme-color" content="#303565">
	<title>Fundação CEFETMINAS</title>

	<!-- CSS -->

	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	<link href="/static/css/materialize.css" type="text/css" rel="stylesheet" media="screen,projection"/>
	<link href="/static/css/card.css" type="text/css" rel="stylesheet" media="screen,projection"/>
	<link href="/static/css/modal.css" type="text/css" rel="stylesheet" media="screen,projection"/>
	<link href="/static/css/table.css" type="text/css" rel="stylesheet" media="screen,projection"/>
	<link href="/static/css/style.css" type="text/css" rel="stylesheet" media="screen,projection"/>
	<!-- Conecta -->
	<link href="/static/css/connect/categories.css" type="text/css" rel="stylesheet" media="screen,projection"/>
	<!-- Favicon -->
	<link href="/static/images/favicon.ico" type="image/x-icon" rel="shortcut icon">
	<!-- ServiceWorker-->
	<link rel="manifest" href="/static/manifest.json">
	<!-- Ícones do Aplicativo-->
	<link rel="apple-touch-icon" href="/static/images/icons/icon-apple.png">
	<!-- iPhone Xs Max (1242px x 2688px) -->
	<link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/static/images/splashscreens/iphonexsmax_splash.png" type="image/png" />
	<!-- iPhone Xs Max (2688 x 1242) -->
	<link
	      rel="apple-touch-startup-image"
	      media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
	      href="/static/images/splashscreens/splash/Default-Landscape-2688h~iphone.png"
	    />

	<!-- iPhone Xr (828px x 1792px) -->
	<link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/static/images/splashscreens/splash/iphonexr_splash.png" type="image/png" />
	<!-- iPhone X, Xs (1125px x 2436px) -->
	<link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/static/images/splashscreens/iphonex_splash.png" type="image/png"/>
	<!-- iPhone 8 Plus, 7 Plus, 6s Plus, 6 Plus (1242px x 2208px) -->
	<link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/static/images/splashscreens/splash/iphoneplus_splash.png" type="image/png" />
	<!-- iPhone 8, 7, 6s, 6 (750px x 1334px) -->
	<link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/static/images/splashscreens/splash/750x1334.png" type="image/png" />
	<!-- iPhone  1920x1080 -->
	<link
		 rel="apple-touch-startup-image"
		 media="screen and (device-width: 640px) and (device-height: 360px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
		 href="/static/images/splashscreens/1920x1080.png"
	 />
	 <!-- iPhone  1080x2336 -->
	<link
		 rel="apple-touch-startup-image"
		 media="screen and (device-width: 540px) and (device-height: 1168px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
		 href="/static/images/splashscreens/1080x2336.png"
	 />
	 <!-- iPhone  1242x2688 -->
	<link
		 rel="apple-touch-startup-image"
		 media="screen and (device-width: 621px) and (device-height: 1344px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
		 href="/static/images/splashscreens/1242x2688.png"
	 />
		<!-- iPhone  2436x1125 -->
	 <link
			 rel="apple-touch-startup-image"
			 media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
			 href="/static/images/splashscreens/splash/2436h.png"
		/>

		<!-- iPhone  2732x2732 -->
	<link href="/static/images/splashscreens/splash/2732.png" media="(device-width: 1366px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image" />
	<link href="/static/images/splashscreens/splash/ipadpro2_splash.png" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image" />
	<link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/static/images/splashscreens/splash/iphone6_splash.png"type="image/png" />
	<link href="/static/images/splashscreens/splash/Default~iphone.png" media="(device-width: 160px) and (device-height: 240px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image" />
	<link href="/static/images/splashscreens/splash/iphone5_splash.png" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image" />
	<link href="/static/images/splashscreens/ipad_splash.png" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image" />
	<link href="/static/images/splashscreens/ipadpro1_splash.png" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image" />
	<link href="/static/images/splashscreens/ipadpro3_splash.png" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image" />
	<link href="/static/images/splashscreens/ipadpro2_splash.png" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image" />
</head>

<body class="default_bg">
	<div class="default_bg_overlay">

		<!-- Menu - Navbar -->

		{%include 'header.html'%}

		<div class="content">

			<div class="container">

				<!-- Contextos cadastrados -->

				{% if categories %}

				<div class="row title_margin">
					<center>
						<font class="ms_bold title_color" size="6">Contextos</font>
					</center>
				</div>

				<div class="row">
					<div class="col s12">
						<div class="card">
							<div class="card-content card_padding">
								<table class="bordered striped responsive-table" id="contexts_table" cellspacing="0">
									<thead>
										<tr>
											<th>
												<font class="ms_bold">NOME</font>
												<font color="#aaaaaa">
													<i class="material-icons icon_sort">swap_vert</i>
												</font>
											</th>
											<th>
												<center>
													<font class="ms_bold">MODERADA</font>
												</center>
											</th>
											<th>
												<center>
													<font class="ms_bold">MEMBROS</font>
												</center>
											</th>
											<th>
												<center>
													<font class="ms_bold">EXCLUIR</font>
												</center>
											</th>
										</tr>
									</thead>
									<tbody>

										{% for category in categories %}

										<tr>
											<td class="tbody_td_border">
												{{category.name}}
											</td>
											<td class="tbody_td_border">
												{% if category.moderated %}
												<center>Sim</center>
												{% else %}
												<center>Não</center>
												{% endif %}
											</td>
											<td class="tbody_td_border">
												<center>
													<a class="waves-effect waves-light modal-trigger" id="edit{{category.id}}" href="#modal{{category.id}}">
														<i class="material-icons table_icon_color">edit</i>
													</a>
												</center>
											</td>
											<td class="tbody_last_td_border">
												<center>
													<a class="waves-effect waves-light modal-trigger" id="remove{{category.id}}" href="#modal_remove{{category.id}}">
														<i class="material-icons table_icon_color">delete</i>
													</a>
												</center>
											</td>
										</tr>

										{% endfor %}

									</tbody>
								</table>
							</div>
						</div>
					</div>
				</div>

				{% endif %}

				<!-- Cadastro de Novas Categorias -->

				{% if user.category<=1000 %}

				<div class="row title_margin">
					<center>
						<font class="ms_bold title_color" size="6">Novo Contexto</font>
					</center>
				</div>

				<div class="row">
					<div class="col s12">
						<div class="card">
							<div class="card-content card_padding">

								<form action="{{url_for('connect.create_category')}}" method="post" id="form_categoryRegister">

									<div class="row add_category">
										<div class="input-field col s12">
											<input id="name" name="name" type="text" class="ms_bold">
											<label for="name" class="ms_bold">Nome do novo contexto:</label>
										</div>
									</div>

									<div class="row add_category">
										<div class="col s12 m12 l6">
											<input type="color" id="ctx_color" name="ctx_color">
											<label for="ctx_color" class="color_label">Cor do contexto</label>
										</div>
										<div class="col s12 m12 l6 margin_cbx">
											<input type="checkbox" id="moderated" name="moderated">
											<label for="moderated" class="moderated_label">Moderada</label>
										</div>
									</div>

									<div class="row members_title">
										<div class="col s12">
											<center>
												<font class="ms_bold" color="#8e8e8e" size="3">
													Adicione membros ao novo conexto:
												</font>
											</center>
										</div>
									</div>

									{% if employeeUsers.count() %}

									<div class="row">
										<div class="col s12">

											<table class="bordered striped responsive-table" id="employee_table" cellspacing="0">
												<thead>
													<tr>
														<th>
															<font class="ms_bold">COLABORADOR</font>
															<font color="#aaaaaa">
																<i class="material-icons icon_sort">swap_vert</i>
															</font>
														</th>
														<th>
															<center>
																<font class="ms_bold">ADICIONAR</font>
															</center>
														</th>
													</tr>
												</thead>
												<tbody>

													{% for employeeUser in employeeUsers %}

													<tr>
														<td class="tbody_td_border">
															<div class="div_maior_993">
																{{employeeUser.name}}
															</div>
															<div class="div_993">
																{{employeeUser.name.split(' ')[0]}} {{employeeUser.name.split(' ')[-1]}}
															</div>
														</td>
														<td class="tbody_last_td_border">
															<center>
																<input class="virtualcb" type="checkbox" id="virtual_cbx_{{employeeUser.id}}" value="{{employeeUser.id}}" />
																<label for="virtual_cbx_{{employeeUser.id}}"></label>
															</center>
														</td>
													</tr>

													{% endfor %}
													{% for employeeUser in employeeUsers %}
													<input type="checkbox" id="cbx_{{employeeUser.id}}" name="members" value="{{employeeUser.id}}" />
													{% endfor %}
												</tbody>
											</table>

										</div>
									</div>

									{% endif %}

									<div class="row send_cancel_margin">
										<div class="col s12">
											<center>
												<a href="javascript:window.location.reload();" class="modal-action modal-close btn waves-effect waves-light cancel_btn">
													Cancelar
												</a>
												<button class="btn waves-effect waves-light send_btn" type="submit">
													Adicionar
												</button>
											</center>
										</div>
									</div>

								</form>
							</div>
						</div>
					</div>
				</div>

				<div class="div_maior_993">
					<div class="fixed-action-btn btn_fixed">
						<a class="btn-floating btn-large waves-effect waves-light btn_back" href="{{url_for('connect.index')}}">
							<i class="material-icons">arrow_back</i>
						</a>
					</div>
				</div>

			</div>

			{%endif%}

			<div class="push"></div>

		</div>

		<!-- Modal - EDIÇÃO DE CATEGORIA -->

		{% for category in categories %}

		<div id="modal{{category.id}}" class="modal modal-fixed-footer">
			<div class="modal-content">

				<div class="fixed-action-btn">
					<a class="modal-action modal-close waves-effect waves-light btn-large btn-floating clear_btn">
						<i class="material-icons">clear</i>
					</a>
				</div>

				<div class="row modal_title_margin">
					<div class="col s12">
						<center>
							<font class="ms_bold" size="6" color="#000">Editar "{{category.name}}"</font>
						</center>
					</div>
				</div>

				<!-- Membros -->

				<div class="row">
					<div class="col l1"></div>
					<div class="col s12 m12 l10">
						<font class="ms_bold" size="4">
							<p>Membros:</p>
						</font>
					</div>
				</div>

				<div class="row">
					<div class="col l1"></div>
					<div class="users_attached_to_category_{{category.id}} col s12 m12 l10">

						{% for rel_category in category.users %}

						<div class="chip">
							<font class="ms_bold" color="#000">
								{{rel_category.user.name.split(' ')[0]}} {{rel_category.user.name.split(' ')[-1]}}
							</font>

							{% if rel_category.administrator==True %}

							<a class="remove_admin_button tooltipped" id="remove_admin_for_{{rel_category.user.id}}_{{rel_category.context.id}}" href="#" data-position="top" data-tooltip="Remover administrador" style="color:gray"><i class="material-icons" style="vertical-align:middle;">star</i></a>

							{% else %}

							<a class="add_admin_button tooltipped" id="add_admin_for_{{rel_category.user.id}}_{{rel_category.context.id}}" href="#" data-position="top" data-tooltip="Tornar administrador" style="color:gray"><i class="material-icons" style="vertical-align:middle;" >star_border</i></a>

							{% endif %}

							<i class="remove_category_button close material-icons tooltipped" id="remove_category_for_{{rel_category.user.id}}_{{rel_category.context.id}}" data-position="top" data-tooltip="Remover categoria" style="color:gray">close</i>
						</div>

						{% endfor %}

					</div>
				</div>

				<div class="row ctg_members">
					<div class="col l1"></div>
					<div class="col s12 m12 l10">
						<font class="ms_bold" size="4">
							<p>Adicionar Membros:</p>
						</font>
					</div>
				</div>

				<div class="row">
					<div class="col l1"></div>
					<div class="input-field col s12 m12 l10">
						<select class="select_user ms_medium" name="user_value_{{category.id}}" id="user_value_{{category.id}}">
							<option value="" disabled selected>Selecione o colaborador:</option>
							{%for employeeUser in employeeUsers_sorted%}
							<option value="{{employeeUser.id}}">{{employeeUser.name}}</option>
							{%endfor%}
						</select>
					</div>
				</div>

				<div class="row send_cancel_margin">
					<div class="col s12">
						<center>
							<a href="javascript:window.location.reload();" class="modal-action modal-close btn waves-effect waves-light cancel_btn">
								Cancelar
							</a>
							<a id="add_user_to_{{category.id}}" class="add_category_button btn waves-effect waves-light generic_btn" href="#">
								Enviar
							</a>
						</center>
					</div>
				</div>

			</div>
		</div>

		<!-- Remove -->

		<div id="modal_remove{{category.id}}" class="modal modal-fixed-footer">
			<div class="modal-content">

				<div class="fixed-action-btn">
					<a class="modal-action modal-close waves-effect waves-light btn-large btn-floating clear_btn">
						<i class="material-icons">clear</i>
					</a>
				</div>

				<div class="row modal_title_margin">
					<div class="col s12">
						<center>
							<font class="ms_bold" size="6" color="#000">Remover "{{category.name}}"</font>
						</center>
					</div>
				</div>

				<!-- Selecionar Categoria destino -->

				<div class="row modal_category_title">
					<div class="col l1"></div>
					<div class="col s12 m12 10">
						<center>
							<font class="ms_bold" color="#000" size="3">
								Selecione um contexto destino para os usuários e posts de "{{category.name}}":
							</font>
						</center>
					</div>
				</div>

				<div class="row">
					<div class="col l1"></div>
					<div class="col s12 m12 10">
						<form method="post" name="form_remove_category" id="form_remove_category" action="{{url_for('connect.remove_category',id=category.id)}}">
							<div class="row">
								<div class="input-field col s12">
									<select class="select_category ms_medium" name="category_value_{{category.id}}" id="category_value_{{category.id}}">
										<option value="0" selected>Não transferir usuários e posts</option>
										{%for cat in categories%}
										{%if cat != category:%}
										<option value="{{cat.id}}">{{cat.name}}</option>
										{%endif%}
										{%endfor%}
									</select>
								</div>
							</div>

							<div class="row send_cancel_margin">
								<div class="col s12">
									<center>
										<a href="javascript:window.location.reload();" class="modal-action modal-close btn waves-effect waves-light cancel_btn">
											Cancelar
										</a>
										<button type="submit" id="remove_category_{{category.id}}" class="btn waves-effect waves-light generic_btn">
											Remover
										</button>
									</center>
								</div>
							</div>

						</form>
					</div>
				</div>

			</div>
		</div>

		{% endfor %}

	</div>

	<!-- Footer -->

	{% include 'footer.html' %}

	<!--  Scripts-->

	<script src="/static/vendor/datatables/jquery.dataTables.js"></script>
	<script src="/static/js/sb-admin-datatables.min.js"></script>
	<script src="/static/js/table.js"></script>
	<script src="/static/js/connect/categories.js"></script>

</body>
</html>
